{"ast":null,"code":"var _jsxFileName = \"/Users/caseyreid/Documents/GitHub/air-qualiti2/src/components/charts/WeeklyAnxietyChart.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, TimeScale } from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport 'chartjs-adapter-date-fns';\nimport { supabase } from '../../supabaseClient';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, TimeScale);\nconst WeeklyAnxietyChart = ({\n  userPreferences\n}) => {\n  _s();\n  const [chartData, setChartData] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // Get the algorithm details\n        const {\n          data: algoData,\n          error: algoError\n        } = await supabase.from('risk_algorithms').select('*').eq('code', 'anxSym96').single();\n        if (algoError) throw algoError;\n\n        // Get the PM2.5 data for the last 7 days\n        const {\n          data: pmData,\n          error: pmError\n        } = await supabase.from('weather_data').select('*').eq('city', userPreferences.city).order('created_at', {\n          ascending: false\n        }).limit(7);\n        if (pmError) throw pmError;\n\n        // Calculate daily risk scores\n        const formattedData = {\n          labels: pmData.map(item => new Date(item.created_at)),\n          datasets: [{\n            label: '7-Day Anxiety Risk',\n            data: pmData.map(item => {\n              const baseRisk = userPreferences.anxietyLevel;\n              const riskIncrease = item.pm25 > algoData.threshold ? algoData.base_ratio : 0;\n              return {\n                x: new Date(item.created_at),\n                y: baseRisk * (1 + riskIncrease)\n              };\n            }),\n            borderColor: 'rgb(75, 192, 192)',\n            backgroundColor: 'rgba(75, 192, 192, 0.1)',\n            borderWidth: 2,\n            tension: 0.1\n          }]\n        };\n        setChartData(formattedData);\n      } catch (err) {\n        console.error('Error fetching anxiety risk data:', err);\n        setError('Failed to load anxiety risk data');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    if (userPreferences.city) {\n      fetchData();\n    }\n  }, [userPreferences]);\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading anxiety risk data...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"Error: \", error]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 21\n  }, this);\n  if (!chartData) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"No anxiety risk data available\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 26\n  }, this);\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    scales: {\n      x: {\n        type: 'time',\n        time: {\n          unit: 'day',\n          displayFormats: {\n            day: 'MMM d'\n          }\n        },\n        title: {\n          display: true,\n          text: 'Date'\n        }\n      },\n      y: {\n        beginAtZero: true,\n        title: {\n          display: true,\n          text: 'Anxiety Risk Score'\n        }\n      }\n    },\n    plugins: {\n      legend: {\n        display: true,\n        position: 'bottom'\n      },\n      tooltip: {\n        mode: 'index',\n        intersect: false\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '400px',\n      width: '100%'\n    },\n    children: /*#__PURE__*/_jsxDEV(Line, {\n      data: chartData,\n      options: options\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n};\n_s(WeeklyAnxietyChart, \"+U+KmwUQ08o91z1Gf8Cwp1b98lo=\");\n_c = WeeklyAnxietyChart;\nexport default WeeklyAnxietyChart;\nvar _c;\n$RefreshReg$(_c, \"WeeklyAnxietyChart\");","map":{"version":3,"names":["React","useState","useEffect","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","TimeScale","Line","supabase","jsxDEV","_jsxDEV","register","WeeklyAnxietyChart","userPreferences","_s","chartData","setChartData","isLoading","setIsLoading","error","setError","fetchData","data","algoData","algoError","from","select","eq","single","pmData","pmError","city","order","ascending","limit","formattedData","labels","map","item","Date","created_at","datasets","label","baseRisk","anxietyLevel","riskIncrease","pm25","threshold","base_ratio","x","y","borderColor","backgroundColor","borderWidth","tension","err","console","children","fileName","_jsxFileName","lineNumber","columnNumber","options","responsive","maintainAspectRatio","scales","type","time","unit","displayFormats","day","title","display","text","beginAtZero","plugins","legend","position","tooltip","mode","intersect","style","height","width","_c","$RefreshReg$"],"sources":["/Users/caseyreid/Documents/GitHub/air-qualiti2/src/components/charts/WeeklyAnxietyChart.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n  TimeScale\n} from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport 'chartjs-adapter-date-fns';\nimport { supabase } from '../../supabaseClient';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n  TimeScale\n);\n\nconst WeeklyAnxietyChart = ({ userPreferences }) => {\n  const [chartData, setChartData] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // Get the algorithm details\n        const { data: algoData, error: algoError } = await supabase\n          .from('risk_algorithms')\n          .select('*')\n          .eq('code', 'anxSym96')\n          .single();\n\n        if (algoError) throw algoError;\n\n        // Get the PM2.5 data for the last 7 days\n        const { data: pmData, error: pmError } = await supabase\n          .from('weather_data')\n          .select('*')\n          .eq('city', userPreferences.city)\n          .order('created_at', { ascending: false })\n          .limit(7);\n\n        if (pmError) throw pmError;\n\n        // Calculate daily risk scores\n        const formattedData = {\n          labels: pmData.map(item => new Date(item.created_at)),\n          datasets: [{\n            label: '7-Day Anxiety Risk',\n            data: pmData.map(item => {\n              const baseRisk = userPreferences.anxietyLevel;\n              const riskIncrease = item.pm25 > algoData.threshold ? algoData.base_ratio : 0;\n              return {\n                x: new Date(item.created_at),\n                y: baseRisk * (1 + riskIncrease)\n              };\n            }),\n            borderColor: 'rgb(75, 192, 192)',\n            backgroundColor: 'rgba(75, 192, 192, 0.1)',\n            borderWidth: 2,\n            tension: 0.1\n          }]\n        };\n\n        setChartData(formattedData);\n      } catch (err) {\n        console.error('Error fetching anxiety risk data:', err);\n        setError('Failed to load anxiety risk data');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    if (userPreferences.city) {\n      fetchData();\n    }\n  }, [userPreferences]);\n\n  if (isLoading) return <div>Loading anxiety risk data...</div>;\n  if (error) return <div>Error: {error}</div>;\n  if (!chartData) return <div>No anxiety risk data available</div>;\n\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    scales: {\n      x: {\n        type: 'time',\n        time: {\n          unit: 'day',\n          displayFormats: {\n            day: 'MMM d'\n          }\n        },\n        title: {\n          display: true,\n          text: 'Date'\n        }\n      },\n      y: {\n        beginAtZero: true,\n        title: {\n          display: true,\n          text: 'Anxiety Risk Score'\n        }\n      }\n    },\n    plugins: {\n      legend: {\n        display: true,\n        position: 'bottom'\n      },\n      tooltip: {\n        mode: 'index',\n        intersect: false\n      }\n    }\n  };\n\n  return (\n    <div style={{ height: '400px', width: '100%' }}>\n      <Line data={chartData} options={options} />\n    </div>\n  );\n};\n\nexport default WeeklyAnxietyChart; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}