{"ast":null,"code":"var _jsxFileName = \"/Users/caseyreid/Documents/GitHub/air-qualiti2/src/components/charts/MonthlyAnxietyChart.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport { supabase } from '../../supabaseClient';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend } from 'chart.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend);\nconst MonthlyAnxietyChart = ({\n  data,\n  userPreferences\n}) => {\n  _s();\n  const [chartData, setChartData] = useState(null);\n  useEffect(() => {\n    const calculateMonthlyAnxietyRisk = async () => {\n      try {\n        // Get the algorithm details\n        const {\n          data: algoData,\n          error: algoError\n        } = await supabase.from('risk_algorithms').select('*').eq('code', 'anxSym961').single();\n        if (algoError) throw algoError;\n\n        // Group data by month and calculate average risk\n        const monthlyData = data.reduce((acc, day) => {\n          const date = new Date(day.date);\n          const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n          if (!acc[monthKey]) {\n            acc[monthKey] = {\n              totalRisk: 0,\n              count: 0,\n              highPMDays: 0\n            };\n          }\n\n          // Count days where PM2.5 > threshold\n          if (day.pm25 > algoData.threshold) {\n            acc[monthKey].highPMDays++;\n          }\n          acc[monthKey].count++;\n          return acc;\n        }, {});\n\n        // Calculate monthly risk scores\n        const labels = [];\n        const riskScores = [];\n        Object.entries(monthlyData).forEach(([month, data]) => {\n          labels.push(month);\n          const baseRisk = userPreferences.anxietyLevel;\n          const riskIncrease = data.highPMDays / data.count * algoData.base_ratio;\n          riskScores.push(baseRisk * (1 + riskIncrease));\n        });\n        setChartData({\n          labels,\n          datasets: [{\n            label: 'Monthly Anxiety Risk Score',\n            data: riskScores,\n            fill: false,\n            borderColor: 'rgb(153, 102, 255)',\n            tension: 0.1\n          }]\n        });\n      } catch (error) {\n        console.error('Error calculating monthly anxiety risk:', error);\n      }\n    };\n    if (data.length > 0) {\n      calculateMonthlyAnxietyRisk();\n    }\n  }, [data, userPreferences]);\n  if (!chartData) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading chart...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 26\n  }, this);\n  const options = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top'\n      },\n      title: {\n        display: true,\n        text: '30-Day Anxiety Risk Assessment'\n      }\n    },\n    scales: {\n      y: {\n        beginAtZero: true,\n        title: {\n          display: true,\n          text: 'Risk Score'\n        }\n      },\n      x: {\n        title: {\n          display: true,\n          text: 'Month'\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Line, {\n    data: chartData,\n    options: options\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 10\n  }, this);\n};\n_s(MonthlyAnxietyChart, \"9euvDhZ+n6eLTlbzwvHmNPhoqAw=\");\n_c = MonthlyAnxietyChart;\nexport default MonthlyAnxietyChart;\nvar _c;\n$RefreshReg$(_c, \"MonthlyAnxietyChart\");","map":{"version":3,"names":["React","useEffect","useState","Line","supabase","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","jsxDEV","_jsxDEV","register","MonthlyAnxietyChart","data","userPreferences","_s","chartData","setChartData","calculateMonthlyAnxietyRisk","algoData","error","algoError","from","select","eq","single","monthlyData","reduce","acc","day","date","Date","monthKey","getFullYear","String","getMonth","padStart","totalRisk","count","highPMDays","pm25","threshold","labels","riskScores","Object","entries","forEach","month","push","baseRisk","anxietyLevel","riskIncrease","base_ratio","datasets","label","fill","borderColor","tension","console","length","children","fileName","_jsxFileName","lineNumber","columnNumber","options","responsive","plugins","legend","position","title","display","text","scales","y","beginAtZero","x","_c","$RefreshReg$"],"sources":["/Users/caseyreid/Documents/GitHub/air-qualiti2/src/components/charts/MonthlyAnxietyChart.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport { supabase } from '../../supabaseClient';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend\n} from 'chart.js';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\nconst MonthlyAnxietyChart = ({ data, userPreferences }) => {\n  const [chartData, setChartData] = useState(null);\n\n  useEffect(() => {\n    const calculateMonthlyAnxietyRisk = async () => {\n      try {\n        // Get the algorithm details\n        const { data: algoData, error: algoError } = await supabase\n          .from('risk_algorithms')\n          .select('*')\n          .eq('code', 'anxSym961')\n          .single();\n\n        if (algoError) throw algoError;\n\n        // Group data by month and calculate average risk\n        const monthlyData = data.reduce((acc, day) => {\n          const date = new Date(day.date);\n          const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n\n          if (!acc[monthKey]) {\n            acc[monthKey] = {\n              totalRisk: 0,\n              count: 0,\n              highPMDays: 0\n            };\n          }\n\n          // Count days where PM2.5 > threshold\n          if (day.pm25 > algoData.threshold) {\n            acc[monthKey].highPMDays++;\n          }\n\n          acc[monthKey].count++;\n\n          return acc;\n        }, {});\n\n        // Calculate monthly risk scores\n        const labels = [];\n        const riskScores = [];\n\n        Object.entries(monthlyData).forEach(([month, data]) => {\n          labels.push(month);\n          const baseRisk = userPreferences.anxietyLevel;\n          const riskIncrease = (data.highPMDays / data.count) * algoData.base_ratio;\n          riskScores.push(baseRisk * (1 + riskIncrease));\n        });\n\n        setChartData({\n          labels,\n          datasets: [\n            {\n              label: 'Monthly Anxiety Risk Score',\n              data: riskScores,\n              fill: false,\n              borderColor: 'rgb(153, 102, 255)',\n              tension: 0.1\n            }\n          ]\n        });\n\n      } catch (error) {\n        console.error('Error calculating monthly anxiety risk:', error);\n      }\n    };\n\n    if (data.length > 0) {\n      calculateMonthlyAnxietyRisk();\n    }\n  }, [data, userPreferences]);\n\n  if (!chartData) return <div>Loading chart...</div>;\n\n  const options = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top',\n      },\n      title: {\n        display: true,\n        text: '30-Day Anxiety Risk Assessment'\n      }\n    },\n    scales: {\n      y: {\n        beginAtZero: true,\n        title: {\n          display: true,\n          text: 'Risk Score'\n        }\n      },\n      x: {\n        title: {\n          display: true,\n          text: 'Month'\n        }\n      }\n    }\n  };\n\n  return <Line data={chartData} options={options} />;\n};\n\nexport default MonthlyAnxietyChart; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}